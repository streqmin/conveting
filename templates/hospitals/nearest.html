{% extends "base.html" %}
{% block content %}
  <h2>ë‚´ ì£¼ë³€ ë™ë¬¼ë³‘ì›</h2>
  <ul id="hospitals-list">
  </ul>
  <script>
if (!navigator.geolocation) {
  alert("ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ì •ë³´ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤");
} else {
  navigator.geolocation.getCurrentPosition(async pos => {
    console.log("++++++++++++++++++++")
    console.log(pos)
    const lat = pos.coords.latitude;
    const lng = pos.coords.longitude;
    const res = await fetch("{% url 'nearest_hospitals' %}?lat=" + lat + "&lng=" + lng);
    if (!res.ok) return alert("ë³‘ì› ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤");
    const list = await res.json();
    const container = document.getElementById("hospitals-list");
    list.forEach(h => {
      const li = document.createElement("li");
      li.innerHTML = `
        <strong>${h.name}</strong><br>
        ${h.address}<br>
        ğŸ“ ${h.phone}<br>
        ğŸš— ${h.distance} km
      `;
      container.appendChild(li);
    });
  }, () => {
    alert("ìœ„ì¹˜ ì‚¬ìš©ì„ í—ˆìš©í•´ì•¼ ì£¼ë³€ ë³‘ì›ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤");
  });
}
  </script>
{% endblock content %}
